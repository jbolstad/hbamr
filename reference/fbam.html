<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit an FBAM model using optimization — fbam • hbamr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit an FBAM model using optimization — fbam"><meta name="description" content="Fit a simplified Bayesian Aldrich-McKelvey model with fixed hyperparameters using optimization via rstan. Users may replace the default priors by supplying their own values for the hyperparameters."><meta property="og:description" content="Fit a simplified Bayesian Aldrich-McKelvey model with fixed hyperparameters using optimization via rstan. Users may replace the default priors by supplying their own values for the hyperparameters."><meta property="og:image" content="https://jbolstad.github.io/hbamr/logo.png"><meta name="google-site-verification" content="69MLv6UCy5t-k76w3j9fryUEcyWbdOd5t5QpYCoctoM"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">hbamr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">2.4.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/hbamr.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jbolstad/hbamr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Fit an FBAM model using optimization</h1>
      <small class="dont-index">Source: <a href="https://github.com/jbolstad/hbamr/blob/main/R/fbam.R" class="external-link"><code>R/fbam.R</code></a></small>
      <div class="d-none name"><code>fbam.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fit a simplified Bayesian Aldrich-McKelvey model with fixed hyperparameters using optimization via <code>rstan</code>. Users may replace the default priors by supplying their own values for the hyperparameters.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">fbam</span><span class="op">(</span></span>
<span>  self <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  stimuli <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"FBAM"</span>,</span>
<span>  allow_miss <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  req_valid <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>  req_unique <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  group_id <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  data <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample.int</a></span><span class="op">(</span><span class="va">.Machine</span><span class="op">$</span><span class="va">integer.max</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  sigma_alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma_beta <span class="op">=</span> <span class="fl">0.3</span>,</span>
<span>  sigma_mu_alpha <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigma_mu_beta <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-self">self<a class="anchor" aria-label="anchor" href="#arg-self"></a></dt>
<dd><p>An optional numerical vector of N ideological self-placements. Any missing data must be coded as NA. If this argument is not supplied (either here or in a previous call to <code><a href="prep_data.html">prep_data()</a></code>), respondent positions will not be estimated. If the data have been prepared in advance via the <code><a href="prep_data.html">prep_data()</a></code> function, the argument supplied here will be ignored.</p></dd>


<dt id="arg-stimuli">stimuli<a class="anchor" aria-label="anchor" href="#arg-stimuli"></a></dt>
<dd><p>An N × J matrix of numerical stimulus placements, where J is the number of stimuli. Any missing data must be coded as NA. This argument will not be used if the data have been prepared in advance via the <code><a href="prep_data.html">prep_data()</a></code> function.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Character: Name of the model to be used. Defaults to FBAM. The available options are the three models with "FBAM" in their name. See the documentation for the <code><a href="hbam.html">hbam()</a></code> function for descriptions of the models.</p></dd>


<dt id="arg-allow-miss">allow_miss<a class="anchor" aria-label="anchor" href="#arg-allow-miss"></a></dt>
<dd><p>Integer specifying how many missing stimulus positions to be accepted for an individual still to be included in the analysis. This argument will not be used if the data have been prepared in advance via the <code><a href="prep_data.html">prep_data()</a></code> function. Defaults to 2.</p></dd>


<dt id="arg-req-valid">req_valid<a class="anchor" aria-label="anchor" href="#arg-req-valid"></a></dt>
<dd><p>Integer specifying how many valid observations to require for a respondent to be included in the analysis. The default is <code>req_valid = J - allow_miss</code>, but if specified, <code>req_valid</code> takes precedence. This argument will not be used if the data have been prepared in advance via the <code><a href="prep_data.html">prep_data()</a></code> function.</p></dd>


<dt id="arg-req-unique">req_unique<a class="anchor" aria-label="anchor" href="#arg-req-unique"></a></dt>
<dd><p>Integer specifying how may unique positions on the ideological scale each respondent is required to have used when placing the stimuli in order to be included in the analysis. The default is <code>req_unique = 2</code>. This argument will not be used if the data have been prepared in advance via the <code><a href="prep_data.html">prep_data()</a></code> function.</p></dd>


<dt id="arg-group-id">group_id<a class="anchor" aria-label="anchor" href="#arg-group-id"></a></dt>
<dd><p>Vector of length N identifying which group each respondent belongs to. The format can be factor, character, integer, or numeric. Respondents with NAs on <code>group_id</code> will be dropped when <code>group_id</code> is supplied. These data are only required by models with <code>"MULTI"</code> in their name and will be ignored when fitting other models.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>List of data that have been prepared in advance via the <code><a href="prep_data.html">prep_data()</a></code> function. Not required if the arguments <code>self</code> and <code>stimuli</code> are provided.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>A positive integer specifying an optional seed for reproducibility. If this argument is not supplied, a random seed will be generated and the function will produce slightly different results on each run.</p></dd>


<dt id="arg-sigma-alpha">sigma_alpha<a class="anchor" aria-label="anchor" href="#arg-sigma-alpha"></a></dt>
<dd><p>A positive numeric value specifying the standard deviation of the prior on the shift parameters in the FBAM model, or the standard deviation of the parameters' deviation from the group-means in FBAM_MULTI models. (This argument will be ignored by HBAM models.) Defaults to B / 5, where B measures the length of the survey scale as the number of possible placements on one side of the center.</p></dd>


<dt id="arg-sigma-beta">sigma_beta<a class="anchor" aria-label="anchor" href="#arg-sigma-beta"></a></dt>
<dd><p>A positive numeric value specifying the standard deviation of the prior on the logged stretch parameters in the FBAM model, or the standard deviation of the logged parameters' deviation from the group-means in FBAM_MULTI models. (This argument will be ignored by HBAM models.) Defaults to .3.</p></dd>


<dt id="arg-sigma-mu-alpha">sigma_mu_alpha<a class="anchor" aria-label="anchor" href="#arg-sigma-mu-alpha"></a></dt>
<dd><p>A positive numeric value specifying the standard deviation of the prior on the group-means of the shift parameters in MULTI-type models. Defaults to B / 10.</p></dd>


<dt id="arg-sigma-mu-beta">sigma_mu_beta<a class="anchor" aria-label="anchor" href="#arg-sigma-mu-beta"></a></dt>
<dd><p>A positive numeric value specifying the standard deviation of the prior on the group-means of the logged stretch parameters in MULTI-type models. Defaults to .2.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Arguments passed to <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-optimizing.html" class="external-link">rstan::optimizing()</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list produced by <code><a href="https://mc-stan.org/rstan/reference/stanmodel-method-optimizing.html" class="external-link">rstan::optimizing()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Loading ANES 2012 data:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">LC2012</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Making a small subset of the data for illustration:</span></span></span>
<span class="r-in"><span><span class="va">self</span> <span class="op">&lt;-</span> <span class="va">LC2012</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">stimuli</span> <span class="op">&lt;-</span> <span class="va">LC2012</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fitting the FBAM model:</span></span></span>
<span class="r-in"><span><span class="va">fit_fbam</span> <span class="op">&lt;-</span> <span class="fu">fbam</span><span class="op">(</span><span class="va">self</span>, <span class="va">stimuli</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of prepared data (values for supplied data in paretheses)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Number of respondents: 654 (1000)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Number of stimuli: 4 (4)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Number of stimuli obs.: 2559 (3564)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> - Range of observations: [-3, 3] ([1, 7])</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Obtaining point estimates for the latent stimulus positions:</span></span></span>
<span class="r-in"><span><span class="va">theta_est</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_est.html">get_est</a></span><span class="op">(</span><span class="va">fit_fbam</span>, par <span class="op">=</span> <span class="st">"theta"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Jørgen Bølstad.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

